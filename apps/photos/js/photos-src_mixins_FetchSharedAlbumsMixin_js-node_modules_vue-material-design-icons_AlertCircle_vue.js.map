{"version":3,"file":"photos-src_mixins_FetchSharedAlbumsMixin_js-node_modules_vue-material-design-icons_AlertCircle_vue.js?v=0291e193230f32b8bf4c","mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACrLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAkBA;AACA;;;;;;;;;;;;;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACpCA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack:///photos/src/mixins/FetchSharedAlbumsMixin.js","webpack:///photos/node_modules/vue-material-design-icons/AlertCircle.vue","webpack:///photos/node_modules/vue-material-design-icons/AlertCircle.vue?vue&type=script&lang=js&","webpack://photos/./node_modules/vue-material-design-icons/AlertCircle.vue?5363","webpack://photos/./node_modules/vue-material-design-icons/AlertCircle.vue?d55e"],"sourcesContent":["function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\n/**\n * @copyright Copyright (c) 2022 Louis Chemineau <louis@chmn.me>\n *\n * @author Louis Chemineau <louis@chmn.me>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport { mapGetters } from 'vuex';\nimport moment from '@nextcloud/moment';\nimport { showError } from '@nextcloud/dialogs';\nimport { getCurrentUser } from '@nextcloud/auth';\nimport client from '../services/DavClient.js';\nimport logger from '../services/logger.js';\nimport { genFileInfo } from '../utils/fileUtils.js';\nimport AbortControllerMixin from './AbortControllerMixin.js';\nexport default {\n  name: 'FetchSharedAlbumsMixin',\n  data: function data() {\n    return {\n      errorFetchingAlbums: null,\n      loadingAlbums: false\n    };\n  },\n  mixins: [AbortControllerMixin],\n  beforeMount: function beforeMount() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this.fetchAlbums();\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }))();\n  },\n  computed: _objectSpread({}, mapGetters(['sharedAlbums'])),\n  methods: {\n    fetchAlbums: function fetchAlbums() {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var _getCurrentUser, response, albums, _error$response;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!_this2.loadingAlbums) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 2:\n                _context2.prev = 2;\n                _this2.loadingAlbums = true;\n                _this2.errorFetchingAlbums = null;\n                _context2.next = 7;\n                return client.getDirectoryContents(\"/photos/\".concat((_getCurrentUser = getCurrentUser()) === null || _getCurrentUser === void 0 ? void 0 : _getCurrentUser.uid, \"/sharedalbums\"), {\n                  data: \"<?xml version=\\\"1.0\\\"?>\\n\\t\\t\\t\\t\\t\\t\\t<d:propfind xmlns:d=\\\"DAV:\\\"\\n\\t\\t\\t\\t\\t\\t\\t\\txmlns:oc=\\\"http://owncloud.org/ns\\\"\\n\\t\\t\\t\\t\\t\\t\\t\\txmlns:nc=\\\"http://nextcloud.org/ns\\\"\\n\\t\\t\\t\\t\\t\\t\\t\\txmlns:ocs=\\\"http://open-collaboration-services.org/ns\\\">\\n\\t\\t\\t\\t\\t\\t\\t\\t<d:prop>\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<nc:last-photo />\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<nc:nbItems />\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<nc:location />\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<nc:dateRange />\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<nc:collaborators />\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<nc:publicLink />\\n\\t\\t\\t\\t\\t\\t\\t\\t</d:prop>\\n\\t\\t\\t\\t\\t\\t\\t</d:propfind>\",\n                  details: true,\n                  signal: _this2.abortController.signal\n                });\n\n              case 7:\n                response = _context2.sent;\n                albums = response.data.filter(function (album) {\n                  var _getCurrentUser2;\n\n                  return album.filename !== \"/photos/\".concat((_getCurrentUser2 = getCurrentUser()) === null || _getCurrentUser2 === void 0 ? void 0 : _getCurrentUser2.uid, \"/sharedalbums\");\n                }).map(function (album) {\n                  return genFileInfo(album);\n                }).map(function (album) {\n                  var _album$dateRange$repl, _album$dateRange;\n\n                  album.collaborators = album.collaborators === '' ? [] : album.collaborators;\n                  var dateRange = JSON.parse((_album$dateRange$repl = (_album$dateRange = album.dateRange) === null || _album$dateRange === void 0 ? void 0 : _album$dateRange.replace(/&quot;/g, '\"')) !== null && _album$dateRange$repl !== void 0 ? _album$dateRange$repl : '{}');\n\n                  if (dateRange.start === null) {\n                    dateRange.start = moment().unix();\n                    dateRange.end = moment().unix();\n                  }\n\n                  var dateRangeFormated = {\n                    startDate: moment.unix(dateRange.start).format('MMMM YYYY'),\n                    endDate: moment.unix(dateRange.end).format('MMMM YYYY')\n                  };\n\n                  if (dateRangeFormated.startDate === dateRangeFormated.endDate) {\n                    return _objectSpread(_objectSpread({}, album), {}, {\n                      date: dateRangeFormated.startDate\n                    });\n                  } else {\n                    return _objectSpread(_objectSpread({}, album), {}, {\n                      date: _this2.t('photos', '{startDate} to {endDate}', dateRangeFormated)\n                    });\n                  }\n                });\n\n                _this2.$store.dispatch('addSharedAlbums', {\n                  albums: albums\n                });\n\n                logger.debug(\"[FetchSharedAlbumsMixin] Fetched \".concat(albums.length, \" new files: \"), albums);\n                _context2.next = 26;\n                break;\n\n              case 13:\n                _context2.prev = 13;\n                _context2.t0 = _context2[\"catch\"](2);\n\n                if (!(((_error$response = _context2.t0.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 404)) {\n                  _context2.next = 19;\n                  break;\n                }\n\n                _this2.errorFetchingAlbums = 404;\n                _context2.next = 24;\n                break;\n\n              case 19:\n                if (!(_context2.t0.code === 'ERR_CANCELED')) {\n                  _context2.next = 23;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 23:\n                _this2.errorFetchingAlbums = _context2.t0;\n\n              case 24:\n                logger.error(t('photos', 'Failed to fetch albums list.'), _context2.t0);\n                showError(t('photos', 'Failed to fetch albums list.'));\n\n              case 26:\n                _context2.prev = 26;\n                _this2.loadingAlbums = false;\n                return _context2.finish(26);\n\n              case 29:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[2, 13, 26, 29]]);\n      }))();\n    }\n  }\n};","import { render, staticRenderFns } from \"./AlertCircle.vue?vue&type=template&id=7b52a7d0&\"\nimport script from \"./AlertCircle.vue?vue&type=script&lang=js&\"\nexport * from \"./AlertCircle.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/admin/Docker/apps2/photos/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('7b52a7d0')) {\n      api.createRecord('7b52a7d0', component.options)\n    } else {\n      api.reload('7b52a7d0', component.options)\n    }\n    module.hot.accept(\"./AlertCircle.vue?vue&type=template&id=7b52a7d0&\", function () {\n      api.rerender('7b52a7d0', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"node_modules/vue-material-design-icons/AlertCircle.vue\"\nexport default component.exports","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  name: \"AlertCircleIcon\",\n  emits: ['click'],\n  props: {\n    title: {\n      type: String,\n    },\n    fillColor: {\n      type: String,\n      default: \"currentColor\"\n    },\n    size: {\n      type: Number,\n      default: 24\n    }\n  }\n}\n","import mod from \"-!../vue-loader/lib/index.js??vue-loader-options!./AlertCircle.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../vue-loader/lib/index.js??vue-loader-options!./AlertCircle.vue?vue&type=script&lang=js&\"","var render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"span\",\n    _vm._b(\n      {\n        staticClass: \"material-design-icon alert-circle-icon\",\n        attrs: {\n          \"aria-hidden\": !_vm.title,\n          \"aria-label\": _vm.title,\n          role: \"img\",\n        },\n        on: {\n          click: function ($event) {\n            return _vm.$emit(\"click\", $event)\n          },\n        },\n      },\n      \"span\",\n      _vm.$attrs,\n      false\n    ),\n    [\n      _c(\n        \"svg\",\n        {\n          staticClass: \"material-design-icon__svg\",\n          attrs: {\n            fill: _vm.fillColor,\n            width: _vm.size,\n            height: _vm.size,\n            viewBox: \"0 0 24 24\",\n          },\n        },\n        [\n          _c(\n            \"path\",\n            {\n              attrs: {\n                d: \"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z\",\n              },\n            },\n            [_vm.title ? _c(\"title\", [_vm._v(_vm._s(_vm.title))]) : _vm._e()]\n          ),\n        ]\n      ),\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }"],"names":[],"sourceRoot":""}