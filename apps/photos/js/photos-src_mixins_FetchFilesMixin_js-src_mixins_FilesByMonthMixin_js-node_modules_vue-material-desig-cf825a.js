/*! For license information please see photos-src_mixins_FetchFilesMixin_js-src_mixins_FilesByMonthMixin_js-node_modules_vue-material-desig-cf825a.js.LICENSE.txt */
"use strict";(self.webpackChunkphotos=self.webpackChunkphotos||[]).push([["src_mixins_FetchFilesMixin_js-src_mixins_FilesByMonthMixin_js-node_modules_vue-material-desig-cf825a"],{66951:(t,e,n)=>{n.d(e,{Z:()=>k});var r=n(59537),i=n(94236),o=n(45994),c=n(3301),a=n(81067),l=n(2161),s=n(80351),u=n.n(s),d=n(79753);function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(t,e,n,r,i,o,c){try{var a=t[o](c),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function y(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function c(t){m(o,r,i,c,a,"next",t)}function a(t){m(o,r,i,c,a,"throw",t)}c(void 0)}))}}function b(){return g.apply(this,arguments)}function g(){return g=y(regeneratorRuntime.mark((function t(){var e,n,r,s,f,h,m,y=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=y.length>0&&void 0!==y[0]?y[0]:"",n=y.length>1&&void 0!==y[1]?y[1]:{},n=p({firstResult:0,nbResults:200,mimesType:c.Oj,onThisDay:!1,onlyFavorites:!1},n),r="/files/".concat((0,o.ts)().uid),s=n.mimesType.reduce((function(t,e){return"".concat(t,"\n\t\t<d:eq>\n\t\t\t<d:prop>\n\t\t\t\t<d:getcontenttype/>\n\t\t\t</d:prop>\n\t\t\t<d:literal>").concat(e,"</d:literal>\n\t\t</d:eq>\n\t")}),""),f=n.onlyFavorites?"<d:eq>\n\t\t\t\t<d:prop>\n\t\t\t\t\t<oc:favorite/>\n\t\t\t\t</d:prop>\n\t\t\t\t<d:literal>1</d:literal>\n\t\t\t</d:eq>":"",h=n.onThisDay?"<d:or>".concat(Array(20).fill(1).map((function(t,e){var n=u()(Date.now()).startOf("day").subtract(3,"d").subtract(e+1,"y"),r=u()(Date.now()).endOf("day").add(3,"d").subtract(e+1,"y");return"<d:and>\n\t\t\t\t<d:gt>\n\t\t\t\t\t<d:prop>\n\t\t\t\t\t\t<d:getlastmodified />\n\t\t\t\t\t</d:prop>\n\t\t\t\t\t<d:literal>".concat(n.format(u().defaultFormatUtc),"</d:literal>\n\t\t\t\t</d:gt>\n\t\t\t\t<d:lt>\n\t\t\t\t\t<d:prop>\n\t\t\t\t\t\t<d:getlastmodified />\n\t\t\t\t\t</d:prop>\n\t\t\t\t\t<d:literal>").concat(r.format(u().defaultFormatUtc),"</d:literal>\n\t\t\t\t</d:lt>\n\t\t\t</d:and>")})).join("\n"),"</d:or>"):"",n=Object.assign({method:"SEARCH",headers:{"content-Type":"text/xml"},data:'<?xml version="1.0" encoding="UTF-8"?>\n\t\t\t<d:searchrequest xmlns:d="DAV:"\n\t\t\t\txmlns:oc="http://owncloud.org/ns"\n\t\t\t\txmlns:nc="http://nextcloud.org/ns"\n\t\t\t\txmlns:ns="https://github.com/icewind1991/SearchDAV/ns"\n\t\t\t\txmlns:ocs="http://open-collaboration-services.org/ns">\n\t\t\t\t<d:basicsearch>\n\t\t\t\t\t<d:select>\n\t\t\t\t\t\t<d:prop>\n\t\t\t\t\t\t\t'.concat(l.N,"\n\t\t\t\t\t\t</d:prop>\n\t\t\t\t\t</d:select>\n\t\t\t\t\t<d:from>\n\t\t\t\t\t\t<d:scope>\n\t\t\t\t\t\t\t<d:href>").concat(r,"/").concat(e,"</d:href>\n\t\t\t\t\t\t\t<d:depth>infinity</d:depth>\n\t\t\t\t\t\t</d:scope>\n\t\t\t\t\t</d:from>\n\t\t\t\t\t<d:where>\n\t\t\t\t\t\t<d:and>\n\t\t\t\t\t\t\t<d:or>\n\t\t\t\t\t\t\t\t").concat(s,"\n\t\t\t\t\t\t\t</d:or>\n\t\t\t\t\t\t\t").concat(f,"\n\t\t\t\t\t\t\t").concat(h,"\n\t\t\t\t\t\t</d:and>\n\t\t\t\t\t</d:where>\n\t\t\t\t\t<d:orderby>\n\t\t\t\t\t\t<d:order>\n\t\t\t\t\t\t\t<d:prop><d:getlastmodified/></d:prop>\n\t\t\t\t\t\t\t<d:descending/>\n\t\t\t\t\t\t</d:order>\n\t\t\t\t\t</d:orderby>\n\t\t\t\t\t<d:limit>\n\t\t\t\t\t\t<d:nresults>").concat(n.nbResults,"</d:nresults>\n\t\t\t\t\t\t<ns:firstresult>").concat(n.firstResult,"</ns:firstresult>\n\t\t\t\t\t</d:limit>\n\t\t\t\t</d:basicsearch>\n\t\t\t</d:searchrequest>"),deep:!0,details:!0},n),t.next=10,a.Z.getDirectoryContents("",n);case 10:return m=t.sent,t.abrupt("return",m.data.map((function(t){return(0,i.AX)(t)})).map((function(t){return p(p({},t),{},{source:(0,d.generateRemoteUrl)("dav".concat(t.filename))})})));case 12:case"end":return t.stop()}}),t)}))),g.apply(this,arguments)}var v=n(32114),O=n(69363),w=n(25108);function F(t){return function(t){if(Array.isArray(t))return j(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return j(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){P(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function P(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _(t,e,n,r,i,o,c){try{var a=t[o](c),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function A(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function c(t){_(o,r,i,c,a,"next",t)}function a(t){_(o,r,i,c,a,"throw",t)}c(void 0)}))}}const k={name:"FetchFilesMixin",mixins:[O.Z],data:function(){return{errorFetchingFiles:null,loadingFiles:!1,doneFetchingFiles:!1,semaphore:new v.Z(30),fetchSemaphore:new v.Z(1),semaphoreSymbol:null,fetchedFileIds:[]}},watch:{$route:function(){this.resetFetchFilesState()}},methods:{fetchFiles:function(){var t=arguments,e=this;return A(regeneratorRuntime.mark((function n(){var i,o,c,a,l,s,u,d,f,p;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=t.length>0&&void 0!==t[0]?t[0]:"",o=t.length>1&&void 0!==t[1]?t[1]:{},c=t.length>2&&void 0!==t[2]?t[2]:[],!e.doneFetchingFiles&&!e.loadingFiles){n.next=5;break}return n.abrupt("return",[]);case 5:return n.next=7,e.semaphore.acquire((function(){return 0}),"fetchFiles");case 7:return a=n.sent,n.next=10,e.fetchSemaphore.acquire();case 10:return l=n.sent,n.prev=11,e.errorFetchingFiles=null,e.loadingFiles=!0,e.semaphoreSymbol=a,u=200,n.next=18,b(i,S(S({firstResult:e.fetchedFileIds.length,nbResults:u},o),{},{signal:e.abortController.signal}));case 18:return(d=n.sent).length!==u&&(e.doneFetchingFiles=!0),f=d.map((function(t){return t.fileid})).filter((function(t){return!e.fetchedFileIds.includes(t)})),(s=e.fetchedFileIds).push.apply(s,F(f.map((function(t){return t.toString()})).filter((function(t){return!c.includes(t)})))),e.$store.dispatch("appendFiles",d),r.Z.debug("[FetchFilesMixin] Fetched ".concat(f.length," new files: "),f),n.abrupt("return",f);case 27:if(n.prev=27,n.t0=n.catch(11),404!==(null===(p=n.t0.response)||void 0===p?void 0:p.status)){n.next=33;break}e.errorFetchingFiles=404,n.next=38;break;case 33:if("ERR_CANCELED"!==n.t0.code){n.next=37;break}return n.abrupt("return",[]);case 37:e.errorFetchingFiles=n.t0;case 38:r.Z.error("Error fetching files",n.t0),w.error(n.t0);case 40:return n.prev=40,e.loadingFiles=!1,e.semaphore.release(a),e.fetchSemaphore.release(l),n.finish(40);case 45:return n.abrupt("return",[]);case 46:case"end":return n.stop()}}),n,null,[[11,27,40,45]])})))()},resetFetchFilesState:function(){this.doneFetchingFiles=!1,this.errorFetchingFiles=null,this.loadingFiles=!1,this.fetchedFileIds=[]}}}},28391:(t,e,n)=>{function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,c=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw c}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,{Z:()=>o});const o={name:"FilesByMonthMixin",computed:{fileIdsByMonth:function(){var t,e=this,n={},i=r(this.fetchedFileIds);try{for(i.s();!(t=i.n()).done;){var o,c=t.value,a=this.files[c];n[a.month]=null!==(o=n[a.month])&&void 0!==o?o:[],n[a.month].push(a.fileid)}}catch(t){i.e(t)}finally{i.f()}return Object.keys(n).forEach((function(t){return n[t].sort(e.sortFilesByTimestamp)})),n},monthsList:function(){return Object.keys(this.fileIdsByMonth).sort((function(t,e){return t>e?-1:1}))}}}},33691:(t,e,n)=>{n.d(e,{Z:()=>i});const r={name:"DeleteIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};const i=(0,n(51900).Z)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",t._b({staticClass:"material-design-icon delete-icon",attrs:{"aria-hidden":!t.title,"aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[n("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[n("path",{attrs:{d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"}},[t.title?n("title",[t._v(t._s(t.title))]):t._e()])])])}),[],!1,null,null,null).exports},2470:(t,e,n)=>{n.d(e,{Z:()=>i});const r={name:"DownloadIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};const i=(0,n(51900).Z)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",t._b({staticClass:"material-design-icon download-icon",attrs:{"aria-hidden":!t.title,"aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[n("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[n("path",{attrs:{d:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"}},[t.title?n("title",[t._v(t._s(t.title))]):t._e()])])])}),[],!1,null,null,null).exports},17288:(t,e,n)=>{n.d(e,{Z:()=>s});var r=n(20629),i=n(79753);function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const l={name:"ActionDownload",components:{NcActionLink:n(33476).NcActionLink},props:{title:{type:String,required:!0},selectedFileIds:{type:Array,required:!0}},computed:c(c({},(0,r.Se)(["files"])),{},{downloadUrl:function(){var t=new URLSearchParams;return t.append("files",JSON.stringify(this.fileNames)),(0,i.generateUrl)("/apps/files/ajax/download.php?".concat(t))},fileNames:function(){var t=this;return this.selectedFileIds.map((function(e){return t.files[e].filename}))}})};const s=(0,n(51900).Z)(l,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("NcActionLink",{attrs:{"close-after-click":!0,href:t.downloadUrl,download:t.downloadUrl,"aria-label":t.title}},[t._v("\n\t"+t._s(t.title)+"\n\t"),t._t("icon",null,{slot:"icon"})],2)}),[],!1,null,null,null).exports}}]);
//# sourceMappingURL=photos-src_mixins_FetchFilesMixin_js-src_mixins_FilesByMonthMixin_js-node_modules_vue-material-desig-cf825a.js.map?v=5f9b28ecb79fd08336ec