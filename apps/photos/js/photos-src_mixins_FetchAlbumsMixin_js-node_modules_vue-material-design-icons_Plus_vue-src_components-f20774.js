/*! For license information please see photos-src_mixins_FetchAlbumsMixin_js-node_modules_vue-material-design-icons_Plus_vue-src_components-f20774.js.LICENSE.txt */
"use strict";(self.webpackChunkphotos=self.webpackChunkphotos||[]).push([["src_mixins_FetchAlbumsMixin_js-node_modules_vue-material-design-icons_Plus_vue-src_components-f20774"],{12945:(n,e,o)=>{o.d(e,{Z:()=>h});var a=o(20629),r=o(80351),l=o.n(r),i=o(82880),s=o(45994),c=o(81067),u=o(59537),p=o(94236);function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function m(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function d(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?m(Object(e),!0).forEach((function(n){f(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):m(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function f(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function A(t,n,e,o,a,r,l){try{var i=t[r](l),s=i.value}catch(t){return void e(t)}i.done?n(s):Promise.resolve(s).then(o,a)}function g(t){return function(){var n=this,e=arguments;return new Promise((function(o,a){var r=t.apply(n,e);function l(t){A(r,o,a,l,i,"next",t)}function i(t){A(r,o,a,l,i,"throw",t)}l(void 0)}))}}const h={name:"FetchAlbumsMixin",data:function(){return{errorFetchingAlbums:null,loadingAlbums:!1}},mixins:[o(69363).Z],beforeMount:function(){var t=this;return g(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.fetchAlbums();case 1:case"end":return n.stop()}}),n)})))()},computed:d({},(0,a.Se)(["albums"])),methods:{fetchAlbums:function(){var n=this;return g(regeneratorRuntime.mark((function e(){var o,a,r,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.loadingAlbums){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,n.loadingAlbums=!0,n.errorFetchingAlbums=null,e.next=7,c.Z.getDirectoryContents("/photos/".concat(null===(o=(0,s.ts)())||void 0===o?void 0:o.uid,"/albums"),{data:'<?xml version="1.0"?>\n\t\t\t\t\t\t\t<d:propfind xmlns:d="DAV:"\n\t\t\t\t\t\t\t\txmlns:oc="http://owncloud.org/ns"\n\t\t\t\t\t\t\t\txmlns:nc="http://nextcloud.org/ns"\n\t\t\t\t\t\t\t\txmlns:ocs="http://open-collaboration-services.org/ns">\n\t\t\t\t\t\t\t\t<d:prop>\n\t\t\t\t\t\t\t\t\t<nc:last-photo />\n\t\t\t\t\t\t\t\t\t<nc:nbItems />\n\t\t\t\t\t\t\t\t\t<nc:location />\n\t\t\t\t\t\t\t\t\t<nc:dateRange />\n\t\t\t\t\t\t\t\t\t<nc:collaborators />\n\t\t\t\t\t\t\t\t\t<nc:publicLink />\n\t\t\t\t\t\t\t\t</d:prop>\n\t\t\t\t\t\t\t</d:propfind>',details:!0,signal:n.abortController.signal});case 7:a=e.sent,r=a.data.filter((function(t){var n;return t.filename!=="/photos/".concat(null===(n=(0,s.ts)())||void 0===n?void 0:n.uid,"/albums")})).map((function(t){return""===t.props.collaborators?t.props.collaborators=[]:"object"===b(t.props.collaborators.collaborator)&&(Array.isArray(t.props.collaborators.collaborator)?t.props.collaborators=t.props.collaborators.collaborator:t.props.collaborators=[t.props.collaborators.collaborator]),t})).map((function(t){return(0,p.AX)(t)})).map((function(t){var e,o,a=JSON.parse(null!==(e=null===(o=t.dateRange)||void 0===o?void 0:o.replace(/&quot;/g,'"'))&&void 0!==e?e:"{}");null===a.start&&(a.start=l()().unix(),a.end=l()().unix());var r={startDate:l().unix(a.start).format("MMMM YYYY"),endDate:l().unix(a.end).format("MMMM YYYY")};return d(d({},t),{},r.startDate===r.endDate?{date:r.startDate}:{date:n.t("photos","{startDate} to {endDate}",r)})})),n.$store.dispatch("addAlbums",{albums:r}),u.Z.debug("[FetchAlbumsMixin] Fetched ".concat(r.length," new files: "),r),e.next=26;break;case 13:if(e.prev=13,e.t0=e.catch(2),404!==(null===(m=e.t0.response)||void 0===m?void 0:m.status)){e.next=19;break}n.errorFetchingAlbums=404,e.next=24;break;case 19:if("ERR_CANCELED"!==e.t0.code){e.next=23;break}return e.abrupt("return");case 23:n.errorFetchingAlbums=e.t0;case 24:u.Z.error(t("photos","Failed to fetch albums list."),e.t0),(0,i.showError)(t("photos","Failed to fetch albums list."));case 26:return e.prev=26,n.loadingAlbums=!1,e.finish(26);case 29:case"end":return e.stop()}}),e,null,[[2,13,26,29]])})))()}}}},90224:(t,n,e)=>{e.d(n,{Z:()=>i});var o=e(87537),a=e.n(o),r=e(23645),l=e.n(r)()(a());l.push([t.id,".album-form[data-v-4b45ca79]{display:flex;flex-direction:column;height:350px;padding:16px}.album-form .form-title[data-v-4b45ca79]{font-weight:bold}.album-form .form-subtitle[data-v-4b45ca79]{color:var(--color-text-lighter)}.album-form .form-inputs[data-v-4b45ca79]{flex-grow:1;justify-items:flex-end}.album-form .form-inputs input[data-v-4b45ca79]{width:100%}.album-form .form-inputs label[data-v-4b45ca79]{display:flex;margin-top:16px}.album-form .form-inputs label[data-v-4b45ca79]  svg{margin-right:12px}.album-form .form-buttons[data-v-4b45ca79]{display:flex;justify-content:space-between}.album-form .form-buttons .left-buttons[data-v-4b45ca79],.album-form .form-buttons .right-buttons[data-v-4b45ca79]{display:flex}.album-form .form-buttons .right-buttons[data-v-4b45ca79]{justify-content:flex-end}.album-form .form-buttons button[data-v-4b45ca79]{margin-right:16px}.left-buttons[data-v-4b45ca79]{flex-grow:1}","",{version:3,sources:["webpack://./src/components/Albums/AlbumForm.vue"],names:[],mappings:"AAkPA,6BACC,YAAA,CACA,qBAAA,CACA,YAAA,CACA,YAAA,CAEA,yCACC,gBAAA,CAGD,4CACC,+BAAA,CAGD,0CACC,WAAA,CACA,sBAAA,CAEA,gDACC,UAAA,CAGD,gDACC,YAAA,CACA,eAAA,CAEA,qDACC,iBAAA,CAKH,2CACC,YAAA,CACA,6BAAA,CAEA,mHACC,YAAA,CAGD,0DACC,wBAAA,CAGD,kDACC,iBAAA,CAKH,+BACC,WAAA",sourcesContent:['$sizes: ("400": ("count": 3, "marginTop": 66, "marginW": 8), "700": ("count": 4, "marginTop": 66, "marginW": 8), "1024": ("count": 5, "marginTop": 66, "marginW": 44), "1280": ("count": 4, "marginTop": 66, "marginW": 44), "1440": ("count": 5, "marginTop": 88, "marginW": 66), "1600": ("count": 6, "marginTop": 88, "marginW": 66), "2048": ("count": 7, "marginTop": 88, "marginW": 66), "2560": ("count": 8, "marginTop": 88, "marginW": 88), "3440": ("count": 9, "marginTop": 88, "marginW": 88), "max": ("count": 10, "marginTop": 88, "marginW": 88));\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.album-form {\n\tdisplay: flex;\n\tflex-direction: column;\n\theight: 350px;\n\tpadding: 16px;\n\n\t.form-title {\n\t\tfont-weight: bold;\n\t}\n\n\t.form-subtitle {\n\t\tcolor: var(--color-text-lighter);\n\t}\n\n\t.form-inputs {\n\t\tflex-grow: 1;\n\t\tjustify-items: flex-end;\n\n\t\tinput {\n\t\t\twidth: 100%;\n\t\t}\n\n\t\tlabel {\n\t\t\tdisplay: flex;\n\t\t\tmargin-top: 16px;\n\n\t\t\t::v-deep svg {\n\t\t\t\tmargin-right: 12px;\n\t\t\t}\n\t\t}\n\t}\n\n\t.form-buttons {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\n\t\t.left-buttons, .right-buttons {\n\t\t\tdisplay: flex;\n\t\t}\n\n\t\t.right-buttons {\n\t\t\tjustify-content: flex-end;\n\t\t}\n\n\t\tbutton {\n\t\t\tmargin-right: 16px;\n\t\t}\n\t}\n}\n\n.left-buttons {\n\tflex-grow: 1;\n}\n'],sourceRoot:""}]);const i=l},17226:(t,n,e)=>{e.d(n,{Z:()=>i});var o=e(87537),a=e.n(o),r=e(23645),l=e.n(r)()(a());l.push([t.id,".manage-collaborators[data-v-34521066]{display:flex;flex-direction:column;padding:20px;height:500px}.manage-collaborators__title[data-v-34521066]{font-weight:bold}.manage-collaborators__subtitle[data-v-34521066]{color:var(--color-text-lighter)}.manage-collaborators__public-link-button[data-v-34521066]{margin:4px 0}.manage-collaborators__form[data-v-34521066]{margin-top:4px 0;display:flex;flex-direction:column}.manage-collaborators__form__input[data-v-34521066]{position:relative;display:block}.manage-collaborators__form__input input[data-v-34521066]{width:100%;padding-left:34px}.manage-collaborators__form__input .loading-icon[data-v-34521066]{position:absolute;top:8px;right:8px}.manage-collaborators__form__list[data-v-34521066]{padding:8px}.manage-collaborators__form__list__result[data-v-34521066]{padding:8px;border-radius:100px;box-sizing:border-box}.manage-collaborators__form__list__result[data-v-34521066],.manage-collaborators__form__list__result *[data-v-34521066]{cursor:pointer !important}.manage-collaborators__form__list__result[data-v-34521066]:hover{background:var(--color-background-dark)}.manage-collaborators__selection[data-v-34521066]{display:flex;flex-direction:column;margin-top:8px;flex-grow:1}.manage-collaborators__selection__item[data-v-34521066]{border-radius:var(--border-radius-pill);padding:0 8px}.manage-collaborators__selection__item[data-v-34521066]:hover{background:var(--color-background-dark)}.manage-collaborators .actions[data-v-34521066]{display:flex;margin-top:8px}.manage-collaborators .actions__public-link[data-v-34521066]{display:flex;align-items:center}.manage-collaborators .actions__slot[data-v-34521066]{flex-grow:1;display:flex;justify-content:flex-end;align-items:center}","",{version:3,sources:["webpack://./src/components/Albums/CollaboratorsSelectionForm.vue"],names:[],mappings:"AA+SA,uCACC,YAAA,CACA,qBAAA,CACA,YAAA,CACA,YAAA,CAEA,8CACC,gBAAA,CAGD,iDACC,+BAAA,CAGD,2DACC,YAAA,CAGD,6CACC,gBAAA,CACA,YAAA,CACA,qBAAA,CAEA,oDACC,iBAAA,CACA,aAAA,CAEA,0DACC,UAAA,CACA,iBAAA,CAGD,kEACC,iBAAA,CACA,OAAA,CACA,SAAA,CAIF,mDACC,WAAA,CAEA,2DACC,WAAA,CACA,mBAAA,CACA,qBAAA,CAEA,wHACC,yBAAA,CAGD,iEACC,uCAAA,CAMJ,kDACC,YAAA,CACA,qBAAA,CACA,cAAA,CACA,WAAA,CAEA,wDACC,uCAAA,CACA,aAAA,CAEA,8DACC,uCAAA,CAKH,gDACC,YAAA,CACA,cAAA,CAEA,6DACC,YAAA,CACA,kBAAA,CAGD,sDACC,WAAA,CACA,YAAA,CACA,wBAAA,CACA,kBAAA",sourcesContent:['$sizes: ("400": ("count": 3, "marginTop": 66, "marginW": 8), "700": ("count": 4, "marginTop": 66, "marginW": 8), "1024": ("count": 5, "marginTop": 66, "marginW": 44), "1280": ("count": 4, "marginTop": 66, "marginW": 44), "1440": ("count": 5, "marginTop": 88, "marginW": 66), "1600": ("count": 6, "marginTop": 88, "marginW": 66), "2048": ("count": 7, "marginTop": 88, "marginW": 66), "2560": ("count": 8, "marginTop": 88, "marginW": 88), "3440": ("count": 9, "marginTop": 88, "marginW": 88), "max": ("count": 10, "marginTop": 88, "marginW": 88));\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.manage-collaborators {\n\tdisplay: flex;\n\tflex-direction: column;\n\tpadding: 20px;\n\theight: 500px;\n\n\t&__title {\n\t\tfont-weight: bold;\n\t}\n\n\t&__subtitle {\n\t\tcolor: var(--color-text-lighter);\n\t}\n\n\t&__public-link-button {\n\t\tmargin: 4px 0;\n\t}\n\n\t&__form {\n\t\tmargin-top: 4px 0;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\n\t\t&__input {\n\t\t\tposition: relative;\n\t\t\tdisplay: block;\n\n\t\t\tinput {\n\t\t\t\twidth: 100%;\n\t\t\t\tpadding-left: 34px;\n\t\t\t}\n\n\t\t\t.loading-icon {\n\t\t\t\tposition: absolute;\n\t\t\t\ttop: calc(36px / 2 - 20px / 2);\n\t\t\t\tright: 8px;\n\t\t\t}\n\t\t}\n\n\t\t&__list {\n\t\t\tpadding: 8px;\n\n\t\t\t&__result {\n\t\t\t\tpadding: 8px;\n\t\t\t\tborder-radius: 100px;\n\t\t\t\tbox-sizing: border-box;\n\n\t\t\t\t&, & * {\n\t\t\t\t\tcursor: pointer !important;\n\t\t\t\t}\n\n\t\t\t\t&:hover {\n\t\t\t\t\tbackground: var(--color-background-dark);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t&__selection {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tmargin-top: 8px;\n\t\tflex-grow: 1;\n\n\t\t&__item {\n\t\t\tborder-radius: var(--border-radius-pill);\n\t\t\tpadding:  0 8px;\n\n\t\t\t&:hover {\n\t\t\t\tbackground: var(--color-background-dark);\n\t\t\t}\n\t\t}\n\t}\n\n\t.actions {\n\t\tdisplay: flex;\n\t\tmargin-top: 8px;\n\n\t\t&__public-link {\n\t\t\tdisplay: flex;\n\t\t\talign-items: center;\n\t\t}\n\n\t\t&__slot {\n\t\t\tflex-grow: 1;\n\t\t\tdisplay: flex;\n\t\t\tjustify-content: flex-end;\n\t\t\talign-items: center;\n\t\t}\n\t}\n}\n'],sourceRoot:""}]);const i=l},40502:(t,n,e)=>{e.d(n,{Z:()=>a});const o={name:"PlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};const a=(0,e(51900).Z)(o,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("span",t._b({staticClass:"material-design-icon plus-icon",attrs:{"aria-hidden":!t.title,"aria-label":t.title,role:"img"},on:{click:function(n){return t.$emit("click",n)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])}),[],!1,null,null,null).exports},75400:(t,n,e)=>{e.d(n,{Z:()=>a});const o={name:"SendIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};const a=(0,e(51900).Z)(o,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("span",t._b({staticClass:"material-design-icon send-icon",attrs:{"aria-hidden":!t.title,"aria-label":t.title,role:"img"},on:{click:function(n){return t.$emit("click",n)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M2,21L23,12L2,3V10L17,12L2,14V21Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])}),[],!1,null,null,null).exports},81196:(t,n,e)=>{e.d(n,{Z:()=>E});var o=e(20629),a=e(93050);const r={name:"AccountMultiplePlusIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var l=e(51900);const i=(0,l.Z)(r,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("span",t._b({staticClass:"material-design-icon account-multiple-plus-icon",attrs:{"aria-hidden":!t.title,"aria-label":t.title,role:"img"},on:{click:function(n){return t.$emit("click",n)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M19 17V19H7V17S7 13 13 13 19 17 19 17M16 8A3 3 0 1 0 13 11A3 3 0 0 0 16 8M19.2 13.06A5.6 5.6 0 0 1 21 17V19H24V17S24 13.55 19.2 13.06M18 5A2.91 2.91 0 0 0 17.11 5.14A5 5 0 0 1 17.11 10.86A2.91 2.91 0 0 0 18 11A3 3 0 0 0 18 5M8 10H5V7H3V10H0V12H3V15H5V12H8Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])}),[],!1,null,null,null).exports;var s=e(75400),c=e(33476),u=e(80351),p=e.n(u),b=e(25503);function m(t,n,e,o,a,r,l){try{var i=t[r](l),s=i.value}catch(t){return void e(t)}i.done?n(s):Promise.resolve(s).then(o,a)}function d(t){return function(){var n=this,e=arguments;return new Promise((function(o,a){var r=t.apply(n,e);function l(t){m(r,o,a,l,i,"next",t)}function i(t){m(r,o,a,l,i,"throw",t)}l(void 0)}))}}function f(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function A(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?f(Object(e),!0).forEach((function(n){g(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):f(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function g(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}const h={name:"AlbumForm",components:{MapMarker:a.Z,AccountMultiplePlus:i,Send:s.Z,NcButton:c.NcButton,NcLoadingIcon:c.NcLoadingIcon,NcTextField:c.NcTextField,CollaboratorsSelectionForm:b.Z},props:{album:{type:Object,default:null},displayBackButton:{type:Boolean,default:!1}},data:function(){return{showCollaboratorView:!1,albumName:"",albumLocation:"",loading:!1}},computed:{editMode:function(){return null!==this.album},sharingEnabled:function(){return void 0!==OC.Share}},mounted:function(){var t=this;this.editMode&&(this.albumName=this.album.basename,this.albumLocation=this.album.location),this.$nextTick((function(){t.$refs.nameInput.$el.getElementsByTagName("input")[0].focus()}))},methods:A(A({},(0,o.nv)(["createAlbum","renameAlbum","updateAlbum"])),{},{submit:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];""===this.albumName||this.loading||(this.editMode?this.handleUpdateAlbum():this.handleCreateAlbum(t))},handleCreateAlbum:function(){var t=arguments,n=this;return d(regeneratorRuntime.mark((function e(){var o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.length>0&&void 0!==t[0]?t[0]:[],e.prev=1,n.loading=!0,e.next=5,n.createAlbum({album:{basename:n.albumName,nbItems:0,location:n.albumLocation,lastPhoto:-1,date:p()().format("MMMM YYYY"),collaborators:o}});case 5:if(a=e.sent,""===n.albumLocation&&0===o.length){e.next=10;break}return e.next=9,n.updateAlbum({albumName:n.albumName,properties:{location:n.albumLocation,collaborators:o}});case 9:a=e.sent;case 10:n.$emit("done",{album:a});case 11:return e.prev=11,n.loading=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,,11,14]])})))()},handleUpdateAlbum:function(){var t=this;return d(regeneratorRuntime.mark((function n(){var e;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,t.loading=!0,e=A({},t.album),t.album.basename===t.albumName){n.next=7;break}return n.next=6,t.renameAlbum({currentAlbumName:t.album.basename,newAlbumName:t.albumName});case 6:e=n.sent;case 7:if(t.album.location===t.albumLocation){n.next=11;break}return n.next=10,t.updateAlbum({albumName:t.albumName,properties:{location:t.albumLocation}});case 10:e.location=n.sent;case 11:t.$emit("done",{album:e});case 12:return n.prev=12,t.loading=!1,n.finish(12);case 15:case"end":return n.stop()}}),n,null,[[0,,12,15]])})))()},back:function(){this.$emit("back")}})};var C=e(93379),v=e.n(C),_=e(7795),y=e.n(_),x=e(90569),k=e.n(x),w=e(3565),O=e.n(w),S=e(19216),N=e.n(S),P=e(44589),L=e.n(P),B=e(90224),D={};D.styleTagTransform=L(),D.setAttributes=O(),D.insert=k().bind(null,"head"),D.domAPI=y(),D.insertStyleElement=N();v()(B.Z,D);B.Z&&B.Z.locals&&B.Z.locals;const E=(0,l.Z)(h,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return t.showCollaboratorView?e("CollaboratorsSelectionForm",{attrs:{"album-name":t.albumName,"allow-public-link":!1},scopedSlots:t._u([{key:"default",fn:function(n){var o=n.collaborators;return[e("span",{staticClass:"left-buttons"},[e("NcButton",{attrs:{"aria-label":t.t("photos","Back to the new album form."),type:"tertiary"},on:{click:function(n){t.showCollaboratorView=!1}}},[t._v("\n\t\t\t\t"+t._s(t.t("photos","Back"))+"\n\t\t\t")])],1),t._v(" "),e("span",{staticClass:"right-buttons"},[e("NcButton",{attrs:{"aria-label":t.editMode?t.t("photos","Save."):t.t("photos","Create the album."),type:"primary",disabled:""===t.albumName.trim()||t.loading},on:{click:function(n){return t.submit(o)}},scopedSlots:t._u([{key:"icon",fn:function(){return[t.loading?e("NcLoadingIcon"):e("Send")]},proxy:!0}],null,!0)},[t._v("\n\t\t\t\t"+t._s(t.editMode?t.t("photos","Save"):t.t("photos","Create album"))+"\n\t\t\t")])],1)]}}])}):e("form",{staticClass:"album-form",on:{submit:function(n){return n.preventDefault(),t.submit.apply(null,arguments)}}},[e("div",{staticClass:"form-inputs"},[e("NcTextField",{ref:"nameInput",attrs:{value:t.albumName,type:"text",name:"name",required:!0,autofocus:"true",placeholder:t.t("photos","Name of the album")},on:{"update:value":function(n){t.albumName=n}}}),t._v(" "),e("label",[e("MapMarker"),e("NcTextField",{attrs:{value:t.albumLocation,name:"location",type:"text",placeholder:t.t("photos","Location of the album")},on:{"update:value":function(n){t.albumLocation=n}}})],1)],1),t._v(" "),e("div",{staticClass:"form-buttons"},[e("span",{staticClass:"left-buttons"},[t.displayBackButton?e("NcButton",{attrs:{"aria-label":t.t("photos","Go back to the previous view."),type:"tertiary"},on:{click:t.back}},[t._v("\n\t\t\t\t"+t._s(t.t("photos","Back"))+"\n\t\t\t")]):t._e()],1),t._v(" "),e("span",{staticClass:"right-buttons"},[t.sharingEnabled&&!t.editMode?e("NcButton",{attrs:{"aria-label":t.t("photos","Go to the add collaborators view."),type:"secondary",disabled:""===t.albumName.trim()||t.loading},on:{click:function(n){t.showCollaboratorView=!0}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("AccountMultiplePlus")]},proxy:!0}],null,!1,1531126728)},[t._v("\n\t\t\t\t"+t._s(t.t("photos","Add collaborators"))+"\n\t\t\t")]):t._e(),t._v(" "),e("NcButton",{attrs:{"aria-label":t.editMode?t.t("photos","Save."):t.t("photos","Create the album."),type:"primary",disabled:""===t.albumName||t.loading},on:{click:function(n){return t.submit()}},scopedSlots:t._u([{key:"icon",fn:function(){return[t.loading?e("NcLoadingIcon"):e("Send")]},proxy:!0}],null,!1,3914512768)},[t._v("\n\t\t\t\t"+t._s(t.editMode?t.t("photos","Save"):t.t("photos","Create album"))+"\n\t\t\t")])],1)])])}),[],!1,null,"4b45ca79",null).exports},25503:(n,e,o)=>{o.d(e,{Z:()=>M});const a={name:"MagnifyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}};var r=o(51900);const l=(0,r.Z)(a,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("span",t._b({staticClass:"material-design-icon magnify-icon",attrs:{"aria-hidden":!t.title,"aria-label":t.title,role:"img"},on:{click:function(n){return t.$emit("click",n)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])}),[],!1,null,null,null).exports;var i=o(31894),s=o(26937),c=o(82880),u=o(45994),p=o(79753),b=o(33476),m=o(59537);function d(t,n,e,o,a,r,l){try{var i=t[r](l),s=i.value}catch(t){return void e(t)}i.done?n(s):Promise.resolve(s).then(o,a)}function f(t){return function(){var n=this,e=arguments;return new Promise((function(o,a){var r=t.apply(n,e);function l(t){d(r,o,a,l,i,"next",t)}function i(t){d(r,o,a,l,i,"throw",t)}l(void 0)}))}}function A(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function g(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?A(Object(e),!0).forEach((function(n){h(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):A(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function h(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var C={USER:0,GROUP:1};const v={name:"CollaboratorsSelectionForm",components:{Magnify:l,Close:i.default,NcLoadingIcon:b.NcLoadingIcon,NcButton:b.NcButton,NcListItemIcon:b.NcListItemIcon,NcTextField:b.NcTextField,NcPopover:b.NcPopover},props:{albumName:{type:String,required:!0},collaborators:{type:Array,default:function(){return[]}},publicLink:{type:String,default:""},allowPublicLink:{type:Boolean,default:!0}},data:function(){return{searchText:"",availableCollaborators:{},selectedCollaboratorsKeys:[],currentSearchResults:[],loadingCollaborators:!1,randomId:Math.random().toString().substring(2,10),publicLinkCopied:!1,config:{minSearchStringLength:parseInt(OC.config["sharing.minSearchStringLength"],10)||0}}},computed:{searchResults:function(){var t=this;return this.currentSearchResults.filter((function(t){return t.id!==(0,u.ts)().uid})).map((function(t){var n=t.type,e=t.id;return"".concat(n,":").concat(e)})).filter((function(n){return!t.selectedCollaboratorsKeys.includes(n)})).map((function(t){return{key:t,height:48}}))},selectedCollaborators:function(){var t=this;return this.selectedCollaboratorsKeys.map((function(n){return t.availableCollaborators[n]}))}},mounted:function(){this.searchCollaborators(),this.selectedCollaboratorsKeys=this.collaborators.map((function(t){var n=t.type,e=t.id;return"".concat(n,":").concat(e)})),this.availableCollaborators=g(g({},this.availableCollaborators),this.collaborators.reduce((function(t,n){return g(g({},t),{},h({},"".concat(n.type,":").concat(n.id),n))}),{}))},methods:{searchCollaborators:function(){var n=this;return f(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(n.searchText.length<n.config.minSearchStringLength)){e.next=3;break}return e.abrupt("return");case 3:return n.loadingCollaborators=!0,e.next=6,s.Z.get((0,p.generateOcsUrl)("core/autocomplete/get"),{params:{search:n.searchText,itemType:"share-recipients",shareTypes:[C.USER,C.GROUP]}});case 6:o=e.sent,n.currentSearchResults=o.data.ocs.data.map((function(t){var n=-1;switch(t.source){case"users":n=OC.Share.SHARE_TYPE_USER;break;case"groups":n=OC.Share.SHARE_TYPE_GROUP}return g(g({},t),{},{type:n})})),n.availableCollaborators=g(g({},n.availableCollaborators),n.currentSearchResults.reduce((function(t,n){return g(g({},t),{},h({},"".concat(n.type,":").concat(n.id),n))}),{})),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),n.errorFetchingCollaborators=e.t0,m.Z.error(t("photos","Failed to fetch collaborators list."),e.t0),(0,c.showError)(t("photos","Failed to fetch collaborators list."));case 16:return e.prev=16,n.loadingCollaborators=!1,e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,11,16,19]])})))()},createPublicLinkForAlbum:function(){var t=this;return f(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",s.Z.put((0,p.generateOcsUrl)("apps/photos/createPublicLink/".concat(t.albumName))));case 1:case"end":return n.stop()}}),n)})))()},deletePublicLink:function(){var t=this;return f(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",s.Z.delete((0,p.generateOcsUrl)("apps/photos/createPublicLink/".concat(t.albumName))));case 1:case"end":return n.stop()}}),n)})))()},copyPublicLink:function(){var t=this;return f(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,navigator.clipboard.writeText(t.publicLink);case 2:t.publicLinkCopied=!0,setTimeout((function(){t.publicLinkCopied=!1}),1e4);case 4:case"end":return n.stop()}}),n)})))()},selectEntity:function(t){this.selectedCollaboratorsKeys.includes(t)||(this.$refs.popover.$refs.popover.hide(),this.selectedCollaboratorsKeys.push(t))},unselectEntity:function(t){var n=this.selectedCollaboratorsKeys.indexOf(t);this.selectedCollaboratorsKeys.splice(n,1)}}};var _=o(93379),y=o.n(_),x=o(7795),k=o.n(x),w=o(90569),O=o.n(w),S=o(3565),N=o.n(S),P=o(19216),L=o.n(P),B=o(44589),D=o.n(B),E=o(17226),j={};j.styleTagTransform=D(),j.setAttributes=N(),j.insert=O().bind(null,"head"),j.domAPI=k(),j.insertStyleElement=L();y()(E.Z,j);E.Z&&E.Z.locals&&E.Z.locals;const M=(0,r.Z)(v,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"manage-collaborators"},[e("h2",{staticClass:"manage-collaborators__title"},[t._v("\n\t\t"+t._s(t.t("photos","Add collaborators"))+"\n\t")]),t._v(" "),e("div",{staticClass:"manage-collaborators__subtitle"},[t._v("\n\t\t"+t._s(t.t("photos","Add people or groups who can edit your album"))+"\n\t")]),t._v(" "),e("form",{staticClass:"manage-collaborators__form",on:{submit:function(t){t.preventDefault()}}},[e("NcPopover",{ref:"popover",attrs:{"auto-size":!0,distance:0}},[e("label",{staticClass:"manage-collaborators__form__input",attrs:{slot:"trigger"},slot:"trigger"},[e("NcTextField",{attrs:{value:t.searchText,autocomplete:"off",type:"search",name:"search","aria-label":t.t("photos","Search for collaborators"),"aria-autocomplete":"list","aria-controls":"manage-collaborators__form__selection-"+t.randomId+" manage-collaborators__form__list-"+t.randomId,placeholder:t.t("photos","Search people or groups")},on:{"update:value":function(n){t.searchText=n},input:t.searchCollaborators}},[e("Magnify",{attrs:{size:16}})],1),t._v(" "),t.loadingCollaborators?e("NcLoadingIcon"):t._e()],1),t._v(" "),e("ul",{staticClass:"manage-collaborators__form__list",attrs:{id:"manage-collaborators__form__list-"+t.randomId}},t._l(t.searchResults,(function(n){return e("li",{key:n.key},[e("a",[e("NcListItemIcon",{staticClass:"manage-collaborators__form__list__result",attrs:{id:t.availableCollaborators[n.key].id,title:t.availableCollaborators[n.key].id,search:t.searchText,"display-name":t.availableCollaborators[n.key].label,"aria-label":t.t("photos","Add {collaboratorLabel} to the collaborators list",{collaboratorLabel:t.availableCollaborators[n.key].label})},on:{click:function(e){return t.selectEntity(n.key)}}})],1)])})),0)])],1),t._v(" "),e("ul",{staticClass:"manage-collaborators__selection"},t._l(t.selectedCollaboratorsKeys,(function(n){return e("li",{key:n,staticClass:"manage-collaborators__selection__item"},[e("NcListItemIcon",{attrs:{id:t.availableCollaborators[n].id,title:t.availableCollaborators[n].id,"display-name":t.availableCollaborators[n].label,"aria-label":t.t("photos","Remove {collaboratorLabel} from the collaborators list",{collaboratorLabel:t.availableCollaborators[n].label})}},[e("NcButton",{attrs:{type:"tertiary","aria-label":t.t("photos","Remove {collaboratorLabel} from the collaborators list",{collaboratorLabel:t.availableCollaborators[n].label})},on:{click:function(e){return t.unselectEntity(n)}}},[e("Close",{attrs:{slot:"icon",size:20},slot:"icon"})],1)],1)],1)})),0),t._v(" "),e("div",{staticClass:"actions"},[t.allowPublicLink?e("div",{staticClass:"actions__public-link"},[t.publicLink?[e("NcButton",{staticClass:"manage-collaborators__public-link-button",attrs:{type:"tertiary-no-background"},on:{click:t.copyPublicLink},scopedSlots:t._u([{key:"icon",fn:function(){return[t.publicLinkCopied?e("Check"):e("ContentCopy")]},proxy:!0}],null,!1,845538853)},[t.publicLinkCopied?[t._v("\n\t\t\t\t\t\t"+t._s(t.t("photos","Public link copied!"))+"\n\t\t\t\t\t")]:[t._v("\n\t\t\t\t\t\t"+t._s(t.t("photos","Copy public link"))+"\n\t\t\t\t\t")]],2),t._v(" "),e("NcButton",{on:{click:t.deletePublicLink}},[e("Close",{attrs:{slot:"icon"},slot:"icon"})],1)]:e("NcButton",{staticClass:"manage-collaborators__public-link-button",attrs:{type:"tertiary-no-background"},on:{click:t.createPublicLinkForAlbum}},[e("Earth",{attrs:{slot:"icon"},slot:"icon"}),t._v("\n\t\t\t\t"+t._s(t.t("photos","Share via public link"))+"\n\t\t\t")],1)],2):t._e(),t._v(" "),e("div",{staticClass:"actions__slot"},[t._t("default",null,{collaborators:t.selectedCollaborators})],2)])])}),[],!1,null,"34521066",null).exports}}]);
//# sourceMappingURL=photos-src_mixins_FetchAlbumsMixin_js-node_modules_vue-material-design-icons_Plus_vue-src_components-f20774.js.map?v=af5453c2b2464303d149